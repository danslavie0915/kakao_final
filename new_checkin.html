<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´ë° - ì•½ì† D-Day</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'kakao-yellow': '#fef01b',
                        'kakao-bg': '#9bbbd4',
                        'kakao-text': '#556677',
                        'kakao-chat-bg': '#b2c7da'
                    },
                    fontFamily: {
                        'kakao': ['Apple SD Gothic Neo', 'Malgun Gothic', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            background: linear-gradient(to bottom, #b2c7da, #9bbbd4);
        }

        .message-bubble {
            max-width: 75%;
            word-wrap: break-word;
            animation: slideIn 0.3s ease-out;
            font-size: 14px;
        }

        .message-other {
            background: white;
            border-radius: 18px 18px 18px 4px;
        }

        .message-user {
            background: #fef01b;
            border-radius: 18px 18px 4px 18px;
            margin-left: auto;
        }

        .status-card {
            background: white;
            border-radius: 16px;
            border: 1px solid #e0e0e0;
            margin: 8px 0;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .location-card {
            background: white;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            margin: 4px 0;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .review-card {
            background: white;
            border-radius: 16px;
            border: 1px solid #e0e0e0;
            margin: 8px 0;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .typing-indicator {
            animation: pulse 1.5s infinite;
        }

        .time-notification {
            background: white;
            border-radius: 20px;
            margin: 12px auto;
            max-width: 280px;
            padding: 12px 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
        }

        .time-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .time-icon {
            width: 24px;
            height: 24px;
            background: #ff6b6b;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .time-text {
            color: #556677;
            font-size: 16px;
            font-weight: 600;
        }

        .notification-sound {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #fef01b;
            color: #333;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            animation: notificationPop 0.5s ease-out;
            z-index: 1000;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        @keyframes notificationPop {
            0% {
                transform: translateY(-20px) scale(0.8);
                opacity: 0;
            }

            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .button-action {
            background: #ffffff;
            color: #556677;
            border: 1px solid #d1d5db;
            border-radius: 12px;
            padding: 12px 20px;
            margin: 8px auto;
            display: block;
            cursor: pointer;
            transition: all 0.2s ease-out;
            font-size: 14px;
            font-weight: 600;
            width: fit-content;
            min-width: 120px;
            text-align: center;
        }

        .button-action:hover {
            background: #f9fafb;
            transform: scale(0.98);
        }

        .button-primary {
            background: #fef01b;
            color: #556677;
            border: 1px solid #e6d600;
            box-shadow: 0 4px 12px rgba(254, 240, 27, 0.4);
        }

        .button-primary:hover {
            background: #e6d600;
            box-shadow: 0 6px 16px rgba(254, 240, 27, 0.5);
        }

        .button-small {
            padding: 8px 16px;
            font-size: 12px;
            min-width: 80px;
        }

        .tag {
            display: inline-block;
            background: #f3f4f6;
            color: #556677;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin: 2px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tag:hover {
            background: #e5e7eb;
        }

        .tag-selected {
            background: #fef01b;
            color: #556677;
        }

        .progress-bar {
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #10b981;
            transition: width 0.3s ease;
        }

        .fab {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: linear-gradient(135deg, #fef01b 0%, #f9e71e 50%, #f4d03f 100%);
            border-radius: 30px;
            display: flex;
            align-items: center;
            padding: 14px 20px;
            box-shadow: 0 6px 20px rgba(254, 240, 27, 0.4), 0 2px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            opacity: 0;
            transform: scale(0);
            max-width: 220px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .fab.show {
            opacity: 1;
            transform: scale(1);
        }

        .fab:hover {
            background: linear-gradient(135deg, #e6d600 0%, #dcc71a 50%, #d4b836 100%);
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(254, 240, 27, 0.5), 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .fab-icon {
            font-size: 22px;
            color: #556677;
            margin-right: 12px;
            flex-shrink: 0;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .fab-text {
            font-size: 14px;
            font-weight: 700;
            color: #556677;
            white-space: nowrap;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
            letter-spacing: -0.3px;
        }
    </style>
</head>

<body class="min-h-screen">
    <!-- ì•Œë¦¼ ì‚¬ìš´ë“œ í‘œì‹œ -->
    <div id="notification-sound" class="notification-sound hidden">
        ğŸ”” ì¹´ë° ì•Œë¦¼
    </div>

    <!-- í”Œë¡œíŒ… ì•¡ì…˜ ë²„íŠ¼ (FAB) -->
    <div id="fab" class="fab" onclick="showTimeSimulator()">
        <span class="fab-icon">â°</span>
        <span class="fab-text">ë‹¤ìŒ ì‹œë‚˜ë¦¬ì˜¤ ì²´í—˜</span>
    </div>

    <!-- ì‹œê°„ ì‹œë®¬ë ˆì´í„° ëª¨ë‹¬ -->
    <div id="time-simulator" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl p-6 w-80">
            <h3 class="text-lg font-bold text-gray-800 mb-4">ì•½ì† D-Day ì‹œë‚˜ë¦¬ì˜¤</h3>
            <div class="space-y-3">
                <button onclick="simulateTime('15:00', 't3h')"
                    class="w-full bg-blue-100 text-blue-800 py-3 px-4 rounded-xl font-medium hover:bg-blue-200 transition-colors">
                    ğŸ•’ T-3H - í˜„ì¬ ìƒí™© ì²´í¬
                </button>
                <button onclick="simulateTime('17:30', 't30m')"
                    class="w-full bg-green-100 text-green-800 py-3 px-4 rounded-xl font-medium hover:bg-green-200 transition-colors">
                    ğŸ“ T-30M - ì‹¤ì‹œê°„ ìœ„ì¹˜ í™•ì¸
                </button>
                <button onclick="simulateTime('17:25', 'departure')"
                    class="w-full bg-orange-100 text-orange-800 py-3 px-4 rounded-xl font-medium hover:bg-orange-200 transition-colors">
                    ğŸš€ ì¶œë°œ ì•Œë¦¼
                </button>
                <button onclick="simulateTime('17:45', 'exception')"
                    class="w-full bg-red-100 text-red-800 py-3 px-4 rounded-xl font-medium hover:bg-red-200 transition-colors">
                    ğŸš¨ ì˜ˆì™¸ ìƒí™© - ì§€ì—° ë°œìƒ
                </button>
                <button onclick="simulateTime('20:30', 'review')"
                    class="w-full bg-purple-100 text-purple-800 py-3 px-4 rounded-xl font-medium hover:bg-purple-200 transition-colors">
                    â­ í›„ê¸° ì‘ì„±
                </button>
            </div>
            <button onclick="closeTimeSimulator()"
                class="w-full mt-4 bg-gray-200 text-gray-700 py-2 px-4 rounded-xl font-medium hover:bg-gray-300 transition-colors">
                ë‹«ê¸°
            </button>
        </div>
    </div>

    <!-- ì¹´ì¹´ì˜¤í†¡ í—¤ë” -->
    <div class="bg-kakao-yellow shadow-sm">
        <div class="max-w-md mx-auto px-4 py-3 flex items-center">
            <button onclick="goBack()" class="mr-3 text-gray-700">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
                </svg>
            </button>
            <div class="flex items-center space-x-3 flex-1">
                <div
                    class="w-10 h-10 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center">
                    <span class="text-white text-lg">ğŸ¤–</span>
                </div>
                <div>
                    <h1 class="font-semibold text-gray-800">ì¹´ë°</h1>
                    <p class="text-xs text-gray-600" id="calming-status">ì•½ì† D-Day ê´€ë¦¬</p>
                </div>
            </div>
            <div class="flex space-x-2">
                <button onclick="showTimeSimulator()"
                    class="text-gray-700 text-xs bg-white bg-opacity-50 px-2 py-1 rounded">
                    â° ì‹œê°„
                </button>
                <button class="text-gray-700">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- ì±„íŒ… ì˜ì—­ -->
    <div class="max-w-md mx-auto bg-kakao-chat-bg min-h-screen">
        <div id="chat-container" class="p-4 space-y-3 pb-20">
            <!-- ë©”ì‹œì§€ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>

        <!-- ì…ë ¥ ì˜ì—­ -->
        <div class="fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-md bg-white border-t p-3">
            <div class="flex items-center space-x-2">
                <button class="text-gray-500">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                    </svg>
                </button>
                <input id="message-input" type="text" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-full focus:outline-none focus:border-kakao-yellow"
                    onkeypress="handleKeyPress(event)">
                <button onclick="sendMessage()"
                    class="bg-kakao-yellow text-gray-800 px-4 py-2 rounded-full font-medium hover:bg-yellow-500 transition-colors">
                    ì „ì†¡
                </button>
            </div>
        </div>
    </div>

    <script>
        let chatContainer = document.getElementById('chat-container');
        let messageInput = document.getElementById('message-input');

        // ì•Œë¦¼ ì‚¬ìš´ë“œ í‘œì‹œ
        function showNotificationSound() {
            const soundDiv = document.getElementById('notification-sound');
            soundDiv.classList.remove('hidden');
            setTimeout(() => {
                soundDiv.classList.add('hidden');
            }, 2000);
        }

        // FAB í‘œì‹œ/ìˆ¨ê¹€ ì œì–´
        function showFAB() {
            const fab = document.getElementById('fab');
            fab.classList.add('show');
        }

        function hideFAB() {
            const fab = document.getElementById('fab');
            fab.classList.remove('show');
        }

        // ë©”ì‹œì§€ ì¶”ê°€ í•¨ìˆ˜
        function addMessage(content, isUser = false, hasButtons = false, buttons = [], isSystem = false) {
            const messageDiv = document.createElement('div');
            let className = `message-bubble p-3 mb-2`;

            if (isSystem) {
                className += ' message-system';
            } else if (isUser) {
                className += ' message-user ml-auto';
            } else {
                className += ' message-other';
            }

            messageDiv.className = className;

            let messageHTML = `<p class="text-sm ${isSystem ? 'text-blue-800 text-center' : 'text-gray-800'}">${content}</p>`;

            if (hasButtons && buttons.length > 0) {
                messageHTML += '<div class="mt-3 flex flex-col items-center space-y-2">';
                buttons.forEach(button => {
                    let buttonClass = 'button-action';
                    if (button.primary) buttonClass += ' button-primary';
                    if (button.small) buttonClass += ' button-small';

                    messageHTML += `<button onclick="${button.action}" class="${buttonClass}">${button.text}</button>`;
                });
                messageHTML += '</div>';
            }

            messageDiv.innerHTML = messageHTML;
            chatContainer.appendChild(messageDiv);
            scrollToBottom();
        }

        // í˜„ì¬ ìƒí™© ì²´í¬ ì¹´ë“œ ì¶”ê°€
        function addStatusCard() {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'status-card p-4 mb-2 max-w-xs';

            cardDiv.innerHTML = `
                <div class="flex items-center space-x-2 mb-3">
                    <span class="text-2xl">ğŸ“</span>
                    <h4 class="font-semibold text-gray-800">í˜„ì¬ ìƒí™© ì²´í¬</h4>
                </div>
                
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-2">
                            <span class="text-lg">ğŸ“</span>
                            <span class="text-sm text-gray-700">í˜„ì¬ ìœ„ì¹˜</span>
                        </div>
                        <span class="text-sm font-medium text-gray-800">ì§‘ (ì˜ˆìƒëŒ€ë¡œ)</span>
                    </div>
                    
                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-2">
                            <span class="text-lg">ğŸš‡</span>
                            <span class="text-sm text-gray-700">êµí†µìˆ˜ë‹¨</span>
                        </div>
                        <span class="text-sm font-medium text-gray-800">ëŒ€ì¤‘êµí†µ (ë³€ê²½ ê°€ëŠ¥)</span>
                    </div>
                    
                    <div class="bg-green-50 p-3 rounded-lg border-l-4 border-green-400">
                        <div class="flex items-center space-x-2 mb-1">
                            <span class="text-lg">â°</span>
                            <span class="text-sm font-semibold text-green-800">ê¶Œì¥ ì¶œë°œì‹œê°„</span>
                        </div>
                        <div class="text-lg font-bold text-green-800">ì˜¤í›„ 6:25</div>
                        <div class="text-xs text-green-600 mt-1">35ë¶„ í›„</div>
                    </div>
                </div>
            `;

            chatContainer.appendChild(cardDiv);
            scrollToBottom();
        }

        // ì‹¤ì‹œê°„ ìœ„ì¹˜ ì¹´ë“œë“¤ ì¶”ê°€
        function addLocationCards() {
            const locations = [
                {
                    name: 'ë‹¨ë¬´ì§€',
                    avatar: 'ë‹¨',
                    color: 'bg-orange-400',
                    location: 'ê°•ë‚¨ì—­ ì¸ê·¼',
                    time: '30ë¶„ ì†Œìš” ì˜ˆì •',
                    status: 'on-time'
                },
                {
                    name: 'ì—°ì–´í”¼ì¹˜',
                    avatar: 'ì—°',
                    color: 'bg-pink-400',
                    location: 'ì„ ë¦‰ì—­ ì¸ê·¼',
                    time: '1ì‹œê°„ ì†Œìš” ì˜ˆì •',
                    status: 'delayed'
                },
                {
                    name: 'ì½˜ì¹˜ì¦ˆ',
                    avatar: 'ì½˜',
                    color: 'bg-blue-400',
                    location: 'ë„ì°© ì™„ë£Œ',
                    time: 'ìŠ¤ì‹œ ì   ëŒ€ê¸° ì¤‘',
                    status: 'arrived'
                }
            ];

            locations.forEach(person => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'location-card';

                const statusColor = person.status === 'arrived' ? 'text-green-600' :
                    person.status === 'delayed' ? 'text-red-600' : 'text-blue-600';

                const statusIcon = person.status === 'arrived' ? 'âœ…' :
                    person.status === 'delayed' ? 'âš ï¸' : 'ğŸš‡';

                cardDiv.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 ${person.color} rounded-full flex items-center justify-center text-white text-sm font-bold">
                                ${person.avatar}
                            </div>
                            <div>
                                <div class="font-medium text-gray-800">${person.name}</div>
                                <div class="text-sm text-gray-600">${person.location}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="flex items-center space-x-1">
                                <span class="text-sm">${statusIcon}</span>
                                <span class="text-sm ${statusColor} font-medium">${person.time}</span>
                            </div>
                        </div>
                    </div>
                `;

                chatContainer.appendChild(cardDiv);
            });
            scrollToBottom();
        }

        // ëŒ€ì•ˆ ê²½ë¡œ ì¹´ë“œ ì¶”ê°€ (ì§€ì—° ë°œìƒ ì‹œ)
        function addAlternativeRouteCard(routes) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'status-card p-4 mb-2 max-w-xs';

            let cardHTML = `<h4 class="font-semibold text-gray-800 mb-3">ğŸ”„ ëŒ€ì•ˆ ê²½ë¡œ</h4>`;

            routes.forEach((route, index) => {
                const statusColor = route.status === 'ì›í™œ' ? 'text-green-600' :
                    route.status === 'ì§€ì—°' ? 'text-red-600' : 'text-orange-600';

                cardHTML += `
                    <div class="p-3 ${index > 0 ? 'border-t border-gray-100' : ''} ${route.recommended ? 'bg-yellow-50 rounded-lg' : ''}">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 ${route.color} rounded-full flex items-center justify-center">
                                    <span class="text-white text-xs font-bold">${route.icon}</span>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-800 text-sm">${route.name}</p>
                                    <p class="text-xs text-gray-600">${route.description}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-semibold text-gray-800">${route.time}</div>
                                <div class="text-xs ${statusColor}">${route.status}</div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="text-xs text-gray-600">
                                ìš”ê¸ˆ: <span class="font-semibold">${route.cost}</span>
                            </div>
                            <button onclick="${route.action}" class="bg-kakao-yellow text-gray-800 px-3 py-1 rounded-lg text-xs font-medium hover:bg-yellow-500 transition-colors">
                                ì„ íƒ
                            </button>
                        </div>
                    </div>
                `;
            });

            cardDiv.innerHTML = cardHTML;
            chatContainer.appendChild(cardDiv);
            scrollToBottom();
        }

        // ë¦¬ë·° íƒœê·¸ ì¹´ë“œ ì¶”ê°€
        function addReviewTagCard() {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'review-card p-4 mb-2 max-w-xs';

            cardDiv.innerHTML = `
                <h4 class="font-semibold text-gray-800 mb-3">ğŸ·ï¸ ë¦¬ë·° íƒœê·¸ ìë™ ìƒì„±</h4>
                <p class="text-sm text-gray-600 mb-3">í›„ê¸°ë¥¼ ë¶„ì„í•´ì„œ íƒœê·¸ë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”!</p>
                
                <div class="space-y-2 mb-4">
                    <div class="text-xs text-gray-500 mb-1">ì¶”ì²œ íƒœê·¸:</div>
                    <div class="flex flex-wrap gap-1">
                        <span class="tag tag-selected" onclick="toggleTag(this)">#ë§›ì§‘ì¶”ì²œ</span>
                        <span class="tag tag-selected" onclick="toggleTag(this)">#ì¡°ìš©í•œë¶„ìœ„ê¸°</span>
                        <span class="tag tag-selected" onclick="toggleTag(this)">#ëŒ€í™”í•˜ê¸°ì¢‹ì€ê³³</span>
                        <span class="tag" onclick="toggleTag(this)">#ì¼ë³¸ì—¬í–‰ëŠë‚Œ</span>
                        <span class="tag" onclick="toggleTag(this)">#ì „ë¬¸ê°€ì†œì”¨</span>
                        <span class="tag" onclick="toggleTag(this)">#ì´ˆë°¥ë§›ì§‘</span>
                    </div>
                </div>
                
                <div class="flex space-x-2">
                    <button onclick="confirmReviewTags()" class="button-action button-primary flex-1 button-small">í™•ì¸</button>
                    <button onclick="editReviewTags()" class="button-action flex-1 button-small">ìˆ˜ì •</button>
                </div>
            `;

            chatContainer.appendChild(cardDiv);
            scrollToBottom();
        }

        // íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„°
        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'message-bubble message-other p-3 mb-2 typing-indicator';
            typingDiv.innerHTML = '<p class="text-sm text-gray-600">ì¹´ë°ì´ ì…ë ¥ ì¤‘...</p>';
            chatContainer.appendChild(typingDiv);
            scrollToBottom();
        }

        function hideTyping() {
            const typing = document.getElementById('typing-indicator');
            if (typing) typing.remove();
        }

        // ìŠ¤í¬ë¡¤ í•˜ë‹¨ìœ¼ë¡œ
        function scrollToBottom() {
            setTimeout(() => {
                window.scrollTo(0, document.body.scrollHeight);
            }, 100);
        }

        // í‚¤ ì…ë ¥ ì²˜ë¦¬
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // ë©”ì‹œì§€ ì „ì†¡
        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            addMessage(message, true);
            messageInput.value = '';
        }

        // ì‹œê°„ ì‹œë®¬ë ˆì´í„° í‘œì‹œ/ìˆ¨ê¹€
        function showTimeSimulator() {
            document.getElementById('time-simulator').classList.remove('hidden');
            hideFAB();
        }

        function closeTimeSimulator() {
            document.getElementById('time-simulator').classList.add('hidden');
        }

        // ì‹œê°„ ì•Œë¦¼ ì¹´ë“œ ì¶”ê°€
        function addTimeNotification(time) {
            const timeDiv = document.createElement('div');
            timeDiv.className = 'time-notification';

            timeDiv.innerHTML = `
                <div class="time-display">
                    <div class="time-icon">â°</div>
                    <div class="time-text">ì‹œê°„: ${time}</div>
                </div>
            `;

            chatContainer.appendChild(timeDiv);
            scrollToBottom();
        }

        // ì‹œê°„ë³„ ì‹œë‚˜ë¦¬ì˜¤ ì‹œë®¬ë ˆì´ì…˜
        function simulateTime(time, type) {
            closeTimeSimulator();
            showNotificationSound();

            addTimeNotification(time);

            setTimeout(() => {
                if (type === 't3h') {
                    sendT3HAlert();
                } else if (type === 't30m') {
                    sendT30MAlert();
                } else if (type === 'exception') {
                    sendExceptionAlert();
                } else if (type === 'departure') {
                    sendDepartureAlert();
                } else if (type === 'review') {
                    sendReviewRequest();
                }
            }, 1000);
        }

        // T-3H ì•Œë¦¼
        function sendT3HAlert() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('ğŸ•’ <strong>T-3H í˜„ì¬ ìƒí™© ì²´í¬</strong><br><br>ì•½ì† 3ì‹œê°„ ì „ì´ì—ìš”! í˜„ì¬ êµí†µ ìƒí™©ì„ í™•ì¸í•´ë“œë¦´ê²Œìš”.');

                setTimeout(() => {
                    addStatusCard();

                    setTimeout(() => {
                        showTyping();
                        setTimeout(() => {
                            hideTyping();
                            addMessage('ì½˜ì¹˜ì¦ˆë‹˜ì˜ ìµœê·¼ íŒ¨í„´ì„ ì°¸ê³ í•´ë³¼ ë•Œ 2í˜¸ì„ ì´ ëœ í˜¼ì¡í•  ê²ƒ ê°™ì•„ìš”. í˜„ì¬ ì‚¬ëŒ ë§ì€ ì‹ ë¶„ë‹¹ì„ ë³´ë‹¤ëŠ” 2í˜¸ì„  íƒ€ê¸°ë¥¼ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.<br><br>ê¶Œì¥ ì¶œë°œ ì‹œê°„ì€ <strong>ì˜¤í›„ 6:25</strong>ì…ë‹ˆë‹¤.');

                            setTimeout(() => {
                                showFAB();
                            }, 2000);
                        }, 2000);
                    }, 1000);
                }, 1000);
            }, 2000);
        }

        // T-30M ì•Œë¦¼
        function sendT30MAlert() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('ğŸ“ <strong>T-30M ì‹¤ì‹œê°„ ìœ„ì¹˜ í™•ì¸</strong><br><br>ì¹´ì¹´ì˜¤ë§µì„ ì—´ì–´, ì¹œêµ¬ë“¤ì˜ ì‹¤ì‹œê°„ ìœ„ì¹˜ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!', false, true, [
                    { text: 'ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ ì—´ê¸°', action: 'openKakaoMap()', primary: false, small: true }
                ]);

                setTimeout(() => {
                    addLocationCards();

                    setTimeout(() => {
                        showFAB();
                    }, 2000);
                }, 1000);
            }, 2000);
        }

        // ì˜ˆì™¸ ìƒí™© ì•Œë¦¼
        function sendExceptionAlert() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('ğŸš¨ <strong>ì˜ˆì™¸ ìƒí™© ë°œìƒ!</strong><br><br>2í˜¸ì„ ì— ì§€ì—°ì´ ë°œìƒí–ˆì–´ìš”. ì•½ì† ì¥ì†Œê¹Œì§€ ëŠ¦ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br><br>ëŒ€ì•ˆ ê²½ë¡œë¥¼ ì¶”ì²œí•´ë“œë¦´ê²Œìš”!', false, false, [], false);

                setTimeout(() => {
                    addMessage('ğŸ”„ ëŒ€ì•ˆ ê²½ë¡œë¥¼ í™•ì¸í•´ë³´ì„¸ìš”:');

                    setTimeout(() => {
                        const alternativeRoutes = [
                            {
                                name: '3í˜¸ì„  í™˜ìŠ¹',
                                description: '3í˜¸ì„  â†’ 2í˜¸ì„  í™˜ìŠ¹',
                                time: '30ë¶„',
                                cost: '1,370ì›',
                                status: 'ì›í™œ',
                                color: 'bg-orange-500',
                                icon: '3',
                                recommended: true,
                                action: "selectAlternativeRoute('3í˜¸ì„  í™˜ìŠ¹')"
                            },
                            {
                                name: 'ë²„ìŠ¤ 740ë²ˆ',
                                description: 'ì§‘ â†’ ì•½ì†ì¥ì†Œ ì§í–‰',
                                time: '35ë¶„',
                                cost: '1,200ì›',
                                status: 'ì•½ê°„ í˜¼ì¡',
                                color: 'bg-green-500',
                                icon: 'ğŸšŒ',
                                recommended: false,
                                action: "selectAlternativeRoute('ë²„ìŠ¤ 740ë²ˆ')"
                            },
                            {
                                name: 'íƒì‹œ',
                                description: 'ì§‘ â†’ ì•½ì†ì¥ì†Œ ì§í–‰',
                                time: '20ë¶„',
                                cost: '10,000ì›',
                                status: 'ì›í™œ',
                                color: 'bg-yellow-500',
                                icon: 'ğŸš•',
                                recommended: false,
                                action: "selectAlternativeRoute('íƒì‹œ')"
                            }
                        ];
                        addAlternativeRouteCard(alternativeRoutes);
                    }, 1000);
                }, 2000);
            }, 2000);
        }

        // ì¶œë°œ ì•Œë¦¼
        function sendDepartureAlert() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('ğŸš€ <strong>ì¶œë°œ ì‹œê°„ì…ë‹ˆë‹¤!</strong><br><br>ì§€ê¸ˆ ë°”ë¡œ ì¶œë°œí•˜ì„¸ìš”! ì¹œêµ¬ë“¤ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš” ğŸ˜Š', false, true, [
                    { text: 'ğŸ—ºï¸ ê¸¸ì°¾ê¸° ì‹œì‘', action: 'startNavigation()', primary: true, small: true }
                ]);

                setTimeout(() => {
                    showFAB();
                }, 2000);
            }, 1500);
        }

        // í›„ê¸° ìš”ì²­
        function sendReviewRequest() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('ë‹¨ë¬´ì§€ë‹˜ì´ ì¶”ì²œí•œ ì´ˆë°¥ì§‘, ë‹¤ë“¤ ë§Œì¡±í•˜ì…¨ë‚˜ìš”? "ì¡°ìš©í•œ ê³³"ì´ë¼ ëŒ€í™”í•˜ê¸° ì¢‹ìœ¼ì…¨ëŠ”ì§€ ê¶ê¸ˆí•´ìš”!');

                // ì‚¬ìš©ì ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜
                setTimeout(() => {
                    addMessage('ì¡°ìš©í•˜ê³  ì¢‹ì•˜ì–´. ê·¸ë¦¬ê³  ì´ˆë°¥ì— ë°¥ì•Œ ê°¯ìˆ˜ê°€ ì •í™•íˆ 320ê°œì˜€ì–´. ì „ë¬¸ê°€ ì†œì”¨ë¼ì„œ ì•„ì£¼ ë§ˆìŒì— ë“¤ì—ˆì–´. ë¶„ìœ„ê¸°ë„ ì •ë§ ì¢‹ì•˜ì–´ ì¼ë³¸ ì—¬í–‰ ì˜¨ê±° ê°™ì•˜ì–´.', true);

                    setTimeout(() => {
                        showTyping();
                        setTimeout(() => {
                            hideTyping();
                            addMessage('ê°ì‚¬í•©ë‹ˆë‹¤! í›„ê¸°ë¥¼ ë¶„ì„í•´ì„œ íƒœê·¸ë¡œ ìë™ ë³€í™˜í•˜ì—¬ ì¹´ì¹´ì˜¤ë§µ ë¦¬ë·°ì— ë°˜ì˜í•´ë“œë¦´ê²Œìš” ğŸ·ï¸');

                            setTimeout(() => {
                                addReviewTagCard();

                                setTimeout(() => {
                                    showFAB();
                                }, 2000);
                            }, 1000);
                        }, 2000);
                    }, 1000);
                }, 2000);
            }, 2000);
        }

        // íƒœê·¸ í† ê¸€
        function toggleTag(element) {
            element.classList.toggle('tag-selected');
        }

        // ë¦¬ë·° íƒœê·¸ í™•ì¸
        function confirmReviewTags() {
            addMessage('í™•ì¸', true);

            setTimeout(() => {
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    addMessage('âœ… ì¹´ì¹´ì˜¤ë§µ ë¦¬ë·°ê°€ ë“±ë¡ë˜ì—ˆì–´ìš”!<br><br>ì„ íƒí•˜ì‹  íƒœê·¸ë“¤ì´ ë°˜ì˜ë˜ì–´ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì—ê²Œ ë„ì›€ì´ ë  ê±°ì˜ˆìš” ğŸ˜Š');

                    setTimeout(() => {
                        showFAB();
                    }, 2000);
                }, 1500);
            }, 500);
        }

        // ë¦¬ë·° íƒœê·¸ ìˆ˜ì •
        function editReviewTags() {
            addMessage('ìˆ˜ì •', true);
            addMessage('íƒœê·¸ë¥¼ ì§ì ‘ ì„ íƒí•´ì„œ ìˆ˜ì •í•´ë³´ì„¸ìš”! í´ë¦­í•˜ë©´ ì„ íƒ/í•´ì œë©ë‹ˆë‹¤.');
        }

        // ëŒ€ì•ˆ ê²½ë¡œ ì„ íƒ
        function selectAlternativeRoute(routeName) {
            addMessage(routeName, true);

            setTimeout(() => {
                showTyping();
                setTimeout(() => {
                    hideTyping();

                    if (routeName === '3í˜¸ì„  í™˜ìŠ¹') {
                        addMessage('ğŸš‡ 3í˜¸ì„  í™˜ìŠ¹ ê²½ë¡œ:<br><br>â€¢ ì†Œìš” ì‹œê°„: 30ë¶„<br>â€¢ 3í˜¸ì„  â†’ 2í˜¸ì„  í™˜ìŠ¹<br>â€¢ ìš”ê¸ˆ: 1,370ì›<br><br>âœ… ê²½ë¡œ ì•ˆë‚´ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤!', false, true, [
                            { text: 'ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µì—ì„œ ë³´ê¸°', action: 'openKakaoMap()', primary: true, small: true }
                        ]);
                    } else if (routeName === 'ë²„ìŠ¤ 740ë²ˆ') {
                        addMessage('ğŸšŒ ë²„ìŠ¤ 740ë²ˆ ê²½ë¡œ:<br><br>â€¢ ì†Œìš” ì‹œê°„: 35ë¶„<br>â€¢ ì§‘ â†’ ì•½ì†ì¥ì†Œ ì§í–‰<br>â€¢ ìš”ê¸ˆ: 1,200ì›<br><br>âœ… ê²½ë¡œ ì•ˆë‚´ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤!', false, true, [
                            { text: 'ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µì—ì„œ ë³´ê¸°', action: 'openKakaoMap()', primary: true, small: true }
                        ]);
                    } else if (routeName === 'íƒì‹œ') {
                        addMessage('ğŸš• íƒì‹œ ì´ìš©:<br><br>â€¢ ì†Œìš” ì‹œê°„: 20ë¶„<br>â€¢ ì§‘ â†’ ì•½ì†ì¥ì†Œ ì§í–‰<br>â€¢ ì˜ˆìƒ ìš”ê¸ˆ: 10,000ì›<br><br>âœ… íƒì‹œ í˜¸ì¶œì„ ë„ì™€ë“œë¦´ê¹Œìš”?', false, true, [
                            { text: 'ğŸš• ì¹´ì¹´ì˜¤T í˜¸ì¶œ', action: 'callKakaoTaxi()', primary: true, small: true },
                            { text: 'ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µì—ì„œ ë³´ê¸°', action: 'openKakaoMap()', primary: false, small: true }
                        ]);
                    }

                    // ì•Œë¦¼ ì™„ë£Œ í›„ FAB í‘œì‹œ
                    setTimeout(() => {
                        showFAB();
                    }, 2000);
                }, 1500);
            }, 500);
        }

        // ì¹´ì¹´ì˜¤T í˜¸ì¶œ
        function callKakaoTaxi() {
            addMessage('ì¹´ì¹´ì˜¤T í˜¸ì¶œ', true);
            showTyping();
            setTimeout(() => {
                hideTyping();
                addMessage('ğŸš• ì¹´ì¹´ì˜¤T ì•±ìœ¼ë¡œ ì—°ê²°í•©ë‹ˆë‹¤!<br><br>íƒì‹œ í˜¸ì¶œì´ ì™„ë£Œë˜ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ìœ„ì¹˜ë¥¼ ì•Œë ¤ë“œë¦´ê²Œìš”.');
            }, 1000);
        }

        // ê¸°íƒ€ í•¨ìˆ˜ë“¤
        function showAlternativeRoute() {
            addMessage('ëŒ€ì•ˆ ê²½ë¡œ ë³´ê¸°', true);
            addMessage('ğŸš‡ 3í˜¸ì„  í™˜ìŠ¹ ê²½ë¡œ: 35ë¶„<br>ğŸšŒ ë²„ìŠ¤ 740ë²ˆ: 40ë¶„<br>ğŸš• íƒì‹œ: 25ë¶„ (12,000ì›)');
        }

        function callTaxi() {
            addMessage('íƒì‹œ í˜¸ì¶œ', true);
            addMessage('ğŸš• íƒì‹œê°€ í˜¸ì¶œë˜ì—ˆì–´ìš”! 5ë¶„ í›„ ë„ì°© ì˜ˆì •ì…ë‹ˆë‹¤.');
        }

        function startNavigation() {
            addMessage('ê¸¸ì°¾ê¸° ì‹œì‘', true);
            openKakaoMap();
        }

        function openKakaoMap() {
            window.open('https://map.kakao.com/', '_blank');
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        // ì´ˆê¸° ë©”ì‹œì§€
        setTimeout(() => {
            addMessage('ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ ì•½ì† D-Dayì˜ˆìš”! ğŸ‰<br><br>ìƒë‹¨ì˜ â° ì‹œê°„ ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ë‹¤ì–‘í•œ ì‹œê°„ëŒ€ì˜ ì•Œë¦¼ì„ ì²´í—˜í•´ë³´ì„¸ìš”!', false, true, [
                { text: 'â° ì‹œë‚˜ë¦¬ì˜¤ ì²´í—˜í•˜ê¸°', action: 'showTimeSimulator()', primary: true }
            ]);
        }, 1000);
    </script>
</body>

</html>
